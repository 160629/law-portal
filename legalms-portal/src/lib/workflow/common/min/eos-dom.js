function $create(b,a){a=a||document;if(b.indexOf("<")>-1){var c=a.createElement("div");c.innerHTML=b;return firstElement(c)}return a.createElement(b)}function $createElement(e,d){var f=d?(d.doc||document):document;if(e.indexOf("<")>-1){var g=f.createElement("div");g.innerHTML=e;e=g.firstChild}else{if(isIE&&d&&(d.name||d.type)){var a=(d.name)?' name="'+d.name+'"':"";var c=(d.type)?' type="'+d.type+'"':"";switch(e){case"input":e=document.createElement("input");if(d.type){e.type=d.type;e.name=d.name}break;default:e="<"+e+a+c+">";e=f.createElement(e);break}delete d.name;delete d.type}else{e=f.createElement(e)}}if(d){if(d.style){for(var b in d.style){e.style[b]=d.style[b]}delete d.style}for(var b in d){e[b]=d[b]}}return e}function createSelect(d,a,c){var f=$createElement("select",c||{});for(var b in d){var e=$createElement("option",{value:b,text:""+d[b],innerHTML:d[b]});if((a||a===0)&&b==a){e.selected=true}f.appendChild(e)}return f}function getViewportHeight(){if(window.innerHeight!=window.undefined){return window.innerHeight}if(document.compatMode=="CSS1Compat"){return document.documentElement.clientHeight}if(document.body){return document.body.clientHeight}return window.undefined}function getViewportWidth(){if(window.innerWidth!=window.undefined){return window.innerWidth}if(document.compatMode=="CSS1Compat"){return document.documentElement.clientWidth}if(document.body){return document.body.clientWidth}return window.undefined}function bodyAddNode(a,b){if(!a){return}b=b||document;var c=b.body.firstChild;if(c){b.body.insertBefore(a,c)}else{b.body.appendChild(a)}}function addClass(d,c){if(!d){return}var a=d.className.split(" ");for(var b=0;b<a.length;b++){if(a[b]==c){return}}a.push(c);d.className=a.join(" ")}function removeClass(d,c){if(!d){return}var a=d.className.split(" ");for(var b=0;b<a.length;b++){if(a[b]==c){a.splice(b,1)}}d.className=a.join(" ")}function getPosition(a){var d=a.offsetTop;var c=a.offsetLeft;var b=a;while(b=b.offsetParent){if(b.tagName=="BODY"){continue}d+=b.offsetTop-b.scrollTop;c+=b.offsetLeft-b.scrollLeft}return{top:d,left:c}}function getAbsPos(d){var b=d.offsetTop;var g=d.offsetLeft;var f=d;while(f=f.offsetParent){if(f&&f.tagName=="BODY"){b-=f.scrollTop;g-=f.scrollLeft;continue}b+=f.offsetTop-f.scrollTop;g+=f.offsetLeft-f.scrollLeft}var a=_get_top_window();if(a!=window){if(isIE){var e=window;do{var h=e.frameElement;if(h){var c=getPosition(h);b=b+c.top-(e.scrollTop||0);g=g+c.left-(e.scrollLeft||0)}e=e.parent}while(e&&e!=a);g+=a.scrollLeft||0;b+=a.scrollTop||0;if(isBorderBox){g=g+2;b=b+2}}else{b=window.screen.top-a.screen.top+b;g=window.screen.left-a.screen.left+g}}return{top:b,left:g}}function getScreenPos(d,a){var g=0;var b=0;if(d==a){return{left:0,top:0}}else{var f=d;while(f&&f!=a){var e=f.frameElement;var c=f.parent;if(e){var h=getPosition(e);g=g+h.left;b=b+h.top}f=f.parent}}return{left:g,top:b}}function createStyle(b,g,a){var e="display:";var f;g=g||document;if(g.styleSheets.length==0){var d=g.createElement("style");g.body.appendChild(d)}var h=g.styleSheets[0];if(!a){b="."+b}if(h.insertRule){var c=h.insertRule(b+"{"+e+"}",h.length);return h.cssRules[c]}else{var c=h.addRule(b,e,-1);if(c==-1){c=h.rules.length-1}return h.rules[c]}}function getScroll(c){var f=c,e=document;if(f==e||f==e.body){var a=window.pageXOffset||e.documentElement.scrollLeft||e.body.scrollLeft||0;var b=window.pageYOffset||e.documentElement.scrollTop||e.body.scrollTop||0;return[a,b]}else{return[f.scrollLeft,f.scrollTop]}}function translatePoints(d,a,g){if(typeof a=="object"||a instanceof Array){g=a[1];a=a[0]}var e=d.style.position;var f=getElementXY(d);var b=parseInt(d.style.left,10);var c=parseInt(d.style.top,10);if(isNaN(b)){b=(e=="relative")?0:d.offsetLeft}if(isNaN(c)){c=(e=="relative")?0:d.offsetTop}return{left:(a-f[0]+b),top:(g-f[1]+c)}}function getElementXY(d,j){var c,k,m,o,h=document.body;if(d&&d.style.display=="none"){return[0,0]}if(d.getBoundingClientRect){try{m=d.getBoundingClientRect();o=getScroll(document);return[m.left+o[0],m.top+o[1]]}catch(i){}}var n=0,l=0;c=d;j=j||h;var a=d.style.position=="absolute";while(c){n+=c.offsetLeft;l+=c.offsetTop;if(!a&&c.style.position=="absolute"){a=true}if(isGecko){k=c;var q=parseInt(k.style.borderTopWidth,10)||0;var f=parseInt(k.style.borderLeftWidth,10)||0;n+=f;l+=q;if(c!=d&&k.style.overflow!="visible"){n+=f;l+=q}}c=c.offsetParent}if(isSafari&&a){n-=h.offsetLeft;l-=h.offsetTop}if(isGecko&&!a){var g=h;n+=parseInt(g.style.borderTopWidth,10)||0;l+=parseInt(g.style.borderTopWidth,10)||0}c=d.parentNode;while(c&&c!=h){if(!isOpera||(c.tagName.toUpperCase()!="TR"&&c.style.display!="inline")){n-=c.scrollLeft||0;l-=c.scrollTop||0}c=c.parentNode}return[n,l]}function setElementXY(b,c,a){if(b.style.position=="static"){b.style.position="relative"}if(a!==true){b.style.left="0px";b.style.top="0px"}var d=translatePoints(b,c);if(c[0]!==false){b.style.left=d.left+"px"}if(c[1]!==false){b.style.top=d.top+"px"}}function firstElement(c,a){if(c){a=a||1;var b=0;var d=c.firstChild;while(d){if(d.nodeType==1){if(++b==a){return d}}d=d.nextSibling}}return null}function prevElement(b,a){if(b){var c=b.previousSibling;while(c){if(c.nodeType==1){return c}c=c.previousSibling}}return null}function nextElement(b,a){if(b){var c=b.nextSibling;while(c){if(c.nodeType==1){return c}c=c.nextSibling}}return null}function getNodeValue(b){var a=null;if(!b){return null}var c=b.getAttribute("__isNullOrEmpty");if(c=="null"){return null}if(c=="empty"){return""}if(b.text){a=b.text}else{if(b.childNodes.length>1){a=b.xml.replace(/<\/?[^>]+>/gi,"")}else{if(b.firstChild){a=b.firstChild.data}}}return a}function removeElement(c){if(!c){return}var b=["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onchange","onfocus","onblur","onkeypress","onkeydown","onkeyup"];for(var a=0;a<b.length;a++){c.setAttribute(b[a],null);c[b[a]]=null}if(c.parentNode){c.parentNode.removeChild(c)}}function getFormElementsValue(e){e=$e(e);var a={};for(var d=0;d<e.elements.length;d++){var c=e.elements[d];if(!c.disabled&&c.name){var b=getElementValue(c);if(a[c.name]!==undefined){a[c.name]=[].concat(a[c.name]);a[c.name].push(b)}else{a[c.name]=b}}}return a}function getElementValue(a){a=$e(a);var f=a.tagName.toLowerCase();function d(g){return g.checked?g.value:null}function e(g){return g.getAttribute("value")!=null?g.value:g.text}var c={input:function(g){switch(g.type.toLowerCase()){case"checkbox":case"radio":return d(g);default:return g.value}},textarea:function(g){return g.value},select:function(l){switch(l.type.toLowerCase()){case"select-one":var h=l.selectedIndex;return h>=0?e(l.options[h]):null;default:var g,m=l.length;if(!m){return null}for(var k=0,g=[];k<m;k++){var j=l.options[k];if(j.selected){g.push(e(j))}}return g}return this[l.type=="select-one"?"selectOne":"selectMany"](l)}};var b=c[f];if(b==null){return null}return b(a)}var CSSUtil=function(e){var d=null;var c=e||document;var b=/(-[a-z])/gi;var a=function(f,g){return g.charAt(1).toUpperCase()};return{createStyleSheet:function(h,m,j){var g;j=j||c;var i=j.getElementsByTagName("head");if(!i||i.length<1){j.documentElement.insertBefore(j.createElement("head"),j.body);i=j.getElementsByTagName("head")}var f=i[0];var l=j.createElement("style");l.setAttribute("type","text/css");if(m){l.setAttribute("id",m)}if(isIE){f.appendChild(l);g=l.styleSheet;try{g.cssText=h}catch(k){}}else{try{l.appendChild(j.createTextNode(h))}catch(k){l.cssText=h}f.appendChild(l);g=l.styleSheet?l.styleSheet:(l.sheet||j.styleSheets[j.styleSheets.length-1])}this.cacheStyleSheet(g);return g},removeStyleSheet:function(h,g){g=g||c;var f=g.getElementById(h);if(f){f.parentNode.removeChild(f)}},swapStyleSheet:function(i,f,h){h=h||c;this.removeStyleSheet(i);var g=h.createElement("link");g.setAttribute("rel","stylesheet");g.setAttribute("type","text/css");g.setAttribute("id",i);g.setAttribute("href",f);h.getElementsByTagName("head")[0].appendChild(g)},refreshCache:function(){return this.getRules(true)},cacheStyleSheet:function(g){if(!d){d={}}try{var i=g.cssRules||g.rules;for(var f=i.length-1;f>=0;--f){d[i[f].selectorText]=i[f]}}catch(h){}},getRules:function(g,k){k=k||c;if(d==null||g){d={};var j=k.styleSheets;for(var h=0,f=j.length;h<f;h++){try{this.cacheStyleSheet(j[h])}catch(l){}}}return d},getRule:function(f,h){var g=this.getRules(h);if(!(f instanceof Array)){return g[f]}for(var j=0;j<f.length;j++){if(g[f[j]]){return g[f[j]]}}return null},updateRule:function(f,j,h){if(!(f instanceof Array)){var k=this.getRule(f);if(k){k.style[j.replace(b,a)]=h;return true}}else{for(var g=0;g<f.length;g++){if(this.updateRule(f[g],j,h)){return true}}}return false},getCssText:function(g){var f=CSSUtil.getRule(g);return f?g+" { "+CSSUtil.getRule(g).style.cssText+" } ":""}}}();